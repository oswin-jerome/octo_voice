import{m as N,f as x,r as V,o as d,c as n,a,u as l,H as Q,w as v,F as m,b as e,h as f,J as b,s as g,t as i,k as w,p as T,n as F,j as h}from"./app.e7e40026.js";import{_ as j}from"./Authenticated.2555fad2.js";import{_ as c,a as k}from"./Label.8609a721.js";import{_ as C}from"./Button.6b402a14.js";/* empty css            */import"./plugin-vue_export-helper.21dcd24c.js";const B=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Create Invoice ",-1),I={class:"py-12"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid gap-4"},H={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},M={class:"p-6 bg-white border-b border-gray-200 grid md:grid-cols-3 lg:grid-cols-4 gap-4"},z={class:""},E=e("option",{value:""},"Select a customer",-1),J=["value"],L={key:0,class:"text-red-500 bg-red-500/10 rounded-lg px-2 py-1 mt-2 text-xs"},O={class:"col-span-2"},G={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},K={class:"p-6 bg-white border-b border-gray-200"},R=["onSubmit"],W={class:"grid md:grid-cols-3 gap-4"},X={class:""},Y=e("option",{value:""},"Select a deliverable",-1),Z=["value"],ee={class:""},te={class:"flex flex-col justify-center items-end"},se=h(" Submit "),oe={key:0,class:"text-red-500 bg-red-500/10 rounded-lg px-2 py-1 mt-2 text-xs"},le={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400 mt-4"},re=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{class:"px-4 py-3"},"Deliverable"),e("th",{class:"px-4 py-3"},"Price"),e("th",{class:"px-4 py-3"},"Quantity"),e("th",{class:"px-4 py-3"},"Total"),e("th",{class:"px-4 py-3"},"Actions")])],-1),ie={class:"px-4 py-3"},ae={class:"px-4 py-3"},de={class:"px-4 py-3"},ne={class:"px-4 py-3"},ce={class:"px-4 py-3"},ue=["onClick"],pe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg grid grid-cols-4"},me={class:"col-span-3 p-3"},_e={class:"text-xs"},ge={class:"p-6 bg-white border-b border-gray-200"},ye={class:""},ve=e("option",{value:"fixed"},"Fixed",-1),fe=e("option",{value:"percent"},"Percentage",-1),be=[ve,fe],he={class:""},xe={class:""},we=e("option",{value:""},null,-1),ke=["value"],qe={key:0},Ve=h(" Submit "),Ne={__name:"Create",props:{deliverables:Array,customers:Array,taxes:Array,errors:Object},setup(u){const s=N({customer_id:"",deliverables:[],discount:0,discount_type:"fixed",taxes:[]}),S=x(()=>{let r=s.deliverables.reduce((t,p)=>t+parseFloat(p.price)*parseFloat(p.qty),0),o=s.taxes.reduce((t,p)=>t+parseFloat(p.value),0);return s.taxes.length>0&&(r=r+r*(o/100)),s.discount_type=="fixed"?r-parseFloat(s.discount):r-r*parseFloat(s.discount)/100}),D=x(()=>{let r=s.deliverables.reduce((o,t)=>o+parseFloat(t.price)*parseFloat(t.qty),0);return s.discount_type=="fixed"?parseFloat(s.discount):r*parseFloat(s.discount)/100}),q=x(()=>s.deliverables.reduce((r,o)=>r+parseFloat(o.price)*parseFloat(o.qty),0)),U=()=>{s.transform(r=>({...r,deliverables:r.deliverables.map(o=>({deliverable_id:o.id,quantity:o.qty,amount_per_unit:o.price})),taxes:r.taxes.map(o=>({tax_id:o.id}))})).post(route("invoices.store"),{preserveState:!0,onSuccess:()=>s.reset()})},_=V(null),y=V(1),$=()=>{console.log(_.value),s.deliverables.push({..._.value,qty:y.value,total:y.value*_.value.price})},A=r=>{s.deliverables.splice(r,1)};return(r,o)=>(d(),n(m,null,[a(l(Q),{title:"Dashboard"}),a(j,null,{header:v(()=>[B]),default:v(()=>[e("div",I,[e("div",P,[e("div",H,[e("div",M,[e("div",z,[a(c,{for:"Customer",value:"Customer"}),f(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>l(s).customer_id=t),id:"Customer",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},[E,(d(!0),n(m,null,g(u.customers,t=>(d(),n("option",{value:t.id,key:t.id},i(t.name),9,J))),128))],512),[[b,l(s).customer_id]]),u.errors.customer_id?(d(),n("p",L,i(u.errors.customer_id),1)):w("",!0)]),e("div",O,[a(c,{for:"description",value:"Description"}),a(k,{modelValue:l(s).description,"onUpdate:modelValue":o[1]||(o[1]=t=>l(s).description=t),id:"description",type:"text",class:"mt-1 block w-full",required:"",autocomplete:"current-description"},null,8,["modelValue"])])])]),e("div",G,[e("div",K,[e("form",{onSubmit:T($,["prevent"])},[e("div",W,[e("div",X,[a(c,{for:"deliverable",value:"Deliverable"}),f(e("select",{"onUpdate:modelValue":o[2]||(o[2]=t=>_.value=t),id:"deliverable",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},[Y,(d(!0),n(m,null,g(u.deliverables,t=>(d(),n("option",{value:t,key:t.id},i(t.name),9,Z))),128))],512),[[b,_.value]])]),e("div",ee,[a(c,{for:"qty",value:"Quantity"}),a(k,{modelValue:y.value,"onUpdate:modelValue":o[3]||(o[3]=t=>y.value=t),id:"qty",type:"text",class:"mt-1 block w-full",required:"",autocomplete:"current-qty"},null,8,["modelValue"])]),e("div",te,[a(c,{class:"opacity-0",for:"qty",value:"Quantity"}),a(C,{class:F(["",{"opacity-25":l(s).processing}]),disabled:l(s).processing},{default:v(()=>[se]),_:1},8,["class","disabled"])])])],40,R),u.errors.deliverables?(d(),n("p",oe,i(u.errors.deliverables),1)):w("",!0),e("table",le,[re,e("tbody",null,[(d(!0),n(m,null,g(l(s).deliverables,(t,p)=>(d(),n("tr",{key:t},[e("td",ie,i(t.name),1),e("td",ae,i(t.price),1),e("td",de,i(t.qty),1),e("td",ne,i(parseFloat(t.total)),1),e("td",ce,[e("button",{onClick:Fe=>A(p)}," remove ",8,ue)])]))),128))])])])]),e("div",pe,[e("div",me,[e("p",null,"Sub Total: "+i(l(q)),1),e("p",null,"Discount: "+i(l(D)),1),(d(!0),n(m,null,g(l(s).taxes,t=>(d(),n("p",{key:t},[h(i(t.name)+": "+i(l(q)*(t.value/100))+" ",1),e("span",_e,i(t.value)+"%",1)]))),128)),e("p",null,"Total: "+i(l(S)),1)]),e("div",ge,[e("div",ye,[a(c,{for:"discount_type",value:"discount_type"}),f(e("select",{"onUpdate:modelValue":o[4]||(o[4]=t=>l(s).discount_type=t),id:"discount_type",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},be,512),[[b,l(s).discount_type]])]),e("div",he,[a(c,{for:"discount",value:"Discount"}),a(k,{modelValue:l(s).discount,"onUpdate:modelValue":o[5]||(o[5]=t=>l(s).discount=t),id:"discount",type:"number",class:"mt-1 block w-full",required:"",autocomplete:"current-discount"},null,8,["modelValue"])]),e("div",xe,[a(c,{for:"taxes",value:"taxes"}),f(e("select",{"onUpdate:modelValue":o[6]||(o[6]=t=>l(s).taxes=t),id:"taxes",multiple:"",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},[we,(d(!0),n(m,null,g(u.taxes,t=>(d(),n("option",{key:t,value:t},[h(i(t.name)+" @"+i(t.value),1),t.type=="percentage"?(d(),n("span",qe,"%")):w("",!0)],8,ke))),128))],512),[[b,l(s).taxes]])])])]),a(C,{onClick:U,class:F(["mt-8",{"opacity-25":l(s).processing}]),disabled:l(s).processing},{default:v(()=>[Ve]),_:1},8,["class","disabled"])])])]),_:1})],64))}};export{Ne as default};
