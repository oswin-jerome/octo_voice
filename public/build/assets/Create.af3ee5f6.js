import{m as $,f as x,r as k,o as r,c as n,a,u as l,H as A,w as v,F as m,b as e,h as g,J as y,s as f,p as N,n as V,t as d,j as w,k as Q}from"./app.e7e40026.js";import{_ as B}from"./Authenticated.2555fad2.js";import{_ as u,a as b}from"./Label.8609a721.js";import{_ as q}from"./Button.6b402a14.js";/* empty css            */import"./plugin-vue_export-helper.21dcd24c.js";const P=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Create Estimate ",-1),j={class:"py-12"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid gap-4"},H={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},I={class:"p-6 bg-white border-b border-gray-200 grid md:grid-cols-3 lg:grid-cols-4 gap-4"},M={class:""},z={class:""},J=e("option",{value:""},"Select a customer",-1),L=["value"],G={class:"col-span-2"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},O={class:"p-6 bg-white border-b border-gray-200"},R=["onSubmit"],W={class:"grid md:grid-cols-3 gap-4"},X={class:""},Y=e("option",{value:""},"Select a deliverable",-1),Z=["value"],ee={class:""},te={class:"flex flex-col justify-center items-end"},se=w(" Submit "),oe={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400 mt-4"},le=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{class:"px-4 py-3"},"Deliverable"),e("th",{class:"px-4 py-3"},"Price"),e("th",{class:"px-4 py-3"},"Quantity"),e("th",{class:"px-4 py-3"},"Total"),e("th",{class:"px-4 py-3"},"Actions")])],-1),ie={class:"px-4 py-3"},ae={class:"px-4 py-3"},de={class:"px-4 py-3"},re={class:"px-4 py-3"},ne={class:"px-4 py-3"},ue=["onClick"],ce={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg grid grid-cols-4"},pe={class:"col-span-3 p-3"},me={class:"p-6 bg-white border-b border-gray-200"},_e={class:""},ve=e("option",{value:"fixed"},"Fixed",-1),ge=e("option",{value:"percent"},"Percentage",-1),ye=[ve,ge],fe={class:""},be={class:""},he=e("option",{value:""},null,-1),xe=["value"],we={key:0},ke=w(" Submit "),Te={__name:"Create",props:{deliverables:Array,customers:Array,taxes:Array},setup(h){const s=$({valid_till:"",customer_id:"",deliverables:[],discount:0,discount_type:"fixed",taxes:[]}),F=x(()=>{let i=s.deliverables.reduce((t,c)=>t+parseFloat(c.price)*parseFloat(c.qty),0),o=s.taxes.reduce((t,c)=>t+parseFloat(c.value),0);return s.taxes.length>0&&s.taxes[0].type==="percentage"&&(i=i+i*(o/100)),s.discount_type=="fixed"?i-parseFloat(s.discount):i-i*parseFloat(s.discount)/100}),C=x(()=>{let i=s.deliverables.reduce((o,t)=>o+parseFloat(t.price)*parseFloat(t.qty),0);return s.discount_type=="fixed"?parseFloat(s.discount):i*parseFloat(s.discount)/100}),D=x(()=>s.deliverables.reduce((i,o)=>i+parseFloat(o.price)*parseFloat(o.qty),0)),S=()=>{s.transform(i=>({...i,deliverables:i.deliverables.map(o=>({deliverable_id:o.id,quantity:o.qty})),taxes:i.taxes.map(o=>({tax_id:o.id}))})).post(route("estimates.store"),{onFinish:()=>s.reset()})},p=k(null),_=k(1),U=()=>{console.log(p.value),s.deliverables.push({...p.value,qty:_.value,total:_.value*p.value.price})},T=i=>{s.deliverables.splice(i,1)};return(i,o)=>(r(),n(m,null,[a(l(A),{title:"Dashboard"}),a(B,null,{header:v(()=>[P]),default:v(()=>[e("div",j,[e("div",E,[e("div",H,[e("div",I,[e("div",M,[a(u,{for:"valid_till",value:"Valid Till"}),a(b,{modelValue:l(s).valid_till,"onUpdate:modelValue":o[0]||(o[0]=t=>l(s).valid_till=t),id:"valid_till",type:"date",class:"mt-1 block w-full",required:"",autocomplete:"current-valid_till"},null,8,["modelValue"])]),e("div",z,[a(u,{for:"Customer",value:"Customer"}),g(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>l(s).customer_id=t),id:"Customer",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},[J,(r(!0),n(m,null,f(h.customers,t=>(r(),n("option",{value:t.id,key:t.id},d(t.name),9,L))),128))],512),[[y,l(s).customer_id]])]),e("div",G,[a(u,{for:"description",value:"Description"}),a(b,{modelValue:l(s).description,"onUpdate:modelValue":o[2]||(o[2]=t=>l(s).description=t),id:"description",type:"text",class:"mt-1 block w-full",required:"",autocomplete:"current-description"},null,8,["modelValue"])])])]),e("div",K,[e("div",O,[e("form",{onSubmit:N(U,["prevent"])},[e("div",W,[e("div",X,[a(u,{for:"deliverable",value:"Deliverable"}),g(e("select",{"onUpdate:modelValue":o[3]||(o[3]=t=>p.value=t),id:"deliverable",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},[Y,(r(!0),n(m,null,f(h.deliverables,t=>(r(),n("option",{value:t,key:t.id},d(t.name),9,Z))),128))],512),[[y,p.value]])]),e("div",ee,[a(u,{for:"qty",value:"Quantity"}),a(b,{modelValue:_.value,"onUpdate:modelValue":o[4]||(o[4]=t=>_.value=t),id:"qty",type:"text",class:"mt-1 block w-full",required:"",autocomplete:"current-qty"},null,8,["modelValue"])]),e("div",te,[a(u,{class:"opacity-0",for:"qty",value:"Quantity"}),a(q,{class:V(["",{"opacity-25":l(s).processing}]),disabled:l(s).processing},{default:v(()=>[se]),_:1},8,["class","disabled"])])])],40,R),e("table",oe,[le,e("tbody",null,[(r(!0),n(m,null,f(l(s).deliverables,(t,c)=>(r(),n("tr",{key:t},[e("td",ie,d(t.name),1),e("td",ae,d(t.price),1),e("td",de,d(t.qty)+" "+d(t.unit),1),e("td",re,d(parseFloat(t.total)),1),e("td",ne,[e("button",{onClick:Ve=>T(c)}," remove ",8,ue)])]))),128))])])])]),e("div",ce,[e("div",pe,[e("p",null,"Sub Total: "+d(l(D)),1),e("p",null,"Discount: "+d(l(C)),1),e("p",null,"Total: "+d(l(F)),1)]),e("div",me,[e("div",_e,[a(u,{for:"discount_type",value:"discount_type"}),g(e("select",{"onUpdate:modelValue":o[5]||(o[5]=t=>l(s).discount_type=t),id:"discount_type",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},ye,512),[[y,l(s).discount_type]])]),e("div",fe,[a(u,{for:"discount",value:"Discount"}),a(b,{modelValue:l(s).discount,"onUpdate:modelValue":o[6]||(o[6]=t=>l(s).discount=t),id:"discount",type:"number",class:"mt-1 block w-full",required:"",autocomplete:"current-discount"},null,8,["modelValue"])]),e("div",be,[a(u,{for:"taxes",value:"taxes"}),g(e("select",{"onUpdate:modelValue":o[7]||(o[7]=t=>l(s).taxes=t),id:"taxes",multiple:"",class:"mt-1 block w-full border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 rounded-md shadow-sm",required:"",autocomplete:"current-unit"},[he,(r(!0),n(m,null,f(h.taxes,t=>(r(),n("option",{key:t,value:t},[w(d(t.name)+" @"+d(t.value),1),t.type=="percentage"?(r(),n("span",we,"%")):Q("",!0)],8,xe))),128))],512),[[y,l(s).taxes]])])])]),a(q,{onClick:S,class:V(["mt-8",{"opacity-25":l(s).processing}]),disabled:l(s).processing},{default:v(()=>[ke]),_:1},8,["class","disabled"])])])]),_:1})],64))}};export{Te as default};
